CombineFirstWave = 10
CombineSecondWave = 15
CombineThirdWave = 20
CombineFourthWave = 25
CombineFifthWave = 30
CombineInfiniteWave = 30

CUSTOMWAVESPAWN = 45

zonescovered ={
Vector(3630.080078, -3393.406494, -991.968750),
Vector(3725.392822, -3118.027832, -1135.968750),
Vector(3752.818359, -3561.272217, -1135.968750),
Vector(3514.319580, -3549.830078, -1135.968750),
Vector(3469.284668, -4026.697266, -1453.968750),
Vector(3749.940186, -3766.953857, -1327.968750),
Vector(3572.994629, -3537.775879, -1327.968750),
Vector(2341.519287, -1534.930298, -1087.968750),
Vector(2686.160156, -1564.753784, -1087.968750),
Vector(2598.855225, -1100.031250, -1087.968750),
Vector(2322.062500, -1208.117065, -1087.968750),
Vector(2469.767334, -1383.358887, -943.968750),
Vector(2316.550781, -573.688782, -1311.124390),
Vector(2672.958984, -1549.951172, -1279.968750),
Vector(2596.150879, -1132.703857, -1279.968750),
Vector(894.827332, -6889.976563, -1521.036865),
Vector(2084.117432, -2336.955566, -1648.000244),
Vector(-5051.602051, -2337.609619, -1567.968750),
Vector(1724.360596, -5038.378906, -943.968750),
Vector(1738.628784, -6130.777344, -783.968750),
Vector(1546.368408, -6139.758301, -783.968750),
Vector(1742.176392, -5689.720703, -783.968750),
Vector(1557.509399, -5718.922852, -783.968750),
Vector(1558.690430, -5813.495117, -975.968750),
Vector(-4571.230469, -7274.612305, -562.274170),
Vector(-1469.321167, -6132.437988, -831.968750),
Vector(-1644.343140, -6114.259766, -831.968750),
Vector(-1721.153809, -5906.699219, -831.968750),
Vector(-1699.226074, -5554.445801, -831.968750),
Vector(-1512.377441, -5037.498535, -785.195496),
Vector(-373.655273, -7631.012207, -735.968750),
Vector(-330.016907, -8080.030762, -735.968750),
Vector(-167.835709, -8075.155762, -735.968750),
Vector(168.808441, -7638.255859, -735.968750),
Vector(-16.242746, -8061.530273, -735.968750),
Vector(157.241043, -8077.421387, -735.968750),
Vector(312.726440, -8043.139648, -927.968750),
Vector(191.213806, -7938.746094, -927.968750),
Vector(-505.456726, -8044.745605, -927.968750),
Vector(-397.670410, -7934.352539, -927.968750),
Vector(-299.207245, -8523.322266, -914.589355),
Vector(184.777374, -8626.286133, -907.975769),
Vector(573.198853, -3128.189697, -991.968750),
Vector(864.526184, -3455.251953, -991.968750),
Vector(581.623230, -3537.771973, -991.968750),
Vector(607.104187, -3332.272217, -1183.968750),
Vector(1003.123657, -3418.820068, -1183.968750),
Vector(992.774902, -3486.927490, -1375.968750),
Vector(1022.224731, -3658.527344, -1183.968750),
Vector(-772.948730, -449.930847, -1135.968750),
Vector(-301.437164, -1523.843994, -1087.968750),
Vector(-528.258606, -1093.916382, -1087.968750),
Vector(-531.098877, -1559.123047, -895.968750),
Vector(-310.474976, -1562.298828, -895.968750),
Vector(-552.725891, -1153.159912, -895.968750),
Vector(-330.313324, -1096.673706, -895.968750),
Vector(-2764.529785, -3550.611084, -943.968750),
Vector(-2731.846680, -4808.134766, -687.968750),
Vector(-2540.807861, -4777.647461, -687.968750),
Vector(-2483.059082, -3532.083252, -943.968750),
Vector(-2331.602295, -3122.073486, -943.968750),
Vector(-2506.738037, -3541.519775, -751.968750),
Vector(-2531.789795, -3104.031250, -751.968750),
Vector(-2301.202148, -3576.101074, -751.968750),
Vector(-2329.423828, -3122.953125, -751.968750),
Vector(-4348.545410, -1136.828369, -607.968750),
Vector(-4322.835938, -1549.334717, -607.968750),
Vector(-4578.127441, -1210.847412, -607.968750),
Vector(-4689.790527, -1364.641968, -799.968750),
Vector(-4370.514648, -1132.160400, -799.968750),
Vector(-4571.730469, -598.202026, -839.085388),
Vector(-5674.109863, -2346.304443, -675.671570),
Vector(7060.395508, -808.848938, -1614.620850),
Vector(-7122.347656, -8207.070313, -535.968750),
Vector(-3556.064697, -7673.255371, -762.358521),
Vector(3227.857666, -8295.691406, -1127.968750),
Vector(7304.261719, -6625.100586, -1479.968750),
Vector(3693.891113, -4817.373535, -1119.968750),
Vector(4570.785645, -1560.428101, -1231.968750),
Vector(4701.909180, -1495.074951, -1231.968750),
Vector(4708.962891, -1140.917969, -1231.968750),
Vector(4482.209473, -1130.671143, -1423.968750),
Vector(4275.757324, -766.322937, -1423.968750),
Vector(4632.283203, -1520.378662, -1423.968750),
}

SPECIALITEMPLACES = {
Vector(167.580078, -2210.652344, -1679.540161),
Vector(-2692.021240, -6773.507324, -1451.963013),
}

ITEMPLACES ={
Vector(-1519.865723, -5730.727539, -850.945496),
Vector(-270.441833, -7977.734375, -946.865173),
Vector(80.403366, -7976.587402, -946.967896),
Vector(1562.991455, -5854.599609, -994.985229),
Vector(3585.679199, -3585.911621, -1346.943848),
Vector(661.535461, -3585.018799, -1202.940552),
Vector(-2434.432373, -3470.406494, -962.876892),
Vector(-4740.133789, -1330.791016, -818.842529),
Vector(-344.790009, -1569.267578, -1106.980713),
Vector(2352.766357, -1353.083740, -1298.983032),
Vector(4615.699219, -1570.663940, -1442.949097),
}

combinespawnzones = {
Vector(6442.648438, -8303.695313, -1439.968750),
Vector(6428.187012, -7712.902344, -1439.968750),
Vector(7844.525879, -8121.503906, -1519.968750),
Vector(6439.689941, -8391.996094, -1439.968750),
Vector(-6599.597168, -8626.787109, -496.171875),
Vector(-6539.720703, -7983.456543, -492.561157),
Vector(-6875.256348, -8143.265137, -527.968750),
Vector(-6896.871094, -8605.182617, -527.968750),
}

function GM:PlayerInitialSpawn(ply)
timer.Simple(2, function() ply:PrintMessage(HUD_PRINTTALK, "[Overwatch]: Disorderly conduct detected in this community.") end )
timer.Simple(4, function() ply:PrintMessage(HUD_PRINTTALK, "[Overwatch]: Contain all threats.") end )
timer.Simple(10, function()ply:PrintMessage(HUD_PRINTTALK, "Type !help to see the game mechanics. ") end )
end

function MapSetup()
table.foreach(SPAWNPOINTS_TO_DELETE, function(key,value)
for k, v in pairs(ents.FindByClass(value)) do
print(v:GetClass())
v:Remove()
end
end)

for k, v in pairs(ents.FindByClass("func_door_rotating")) do
print(v:GetClass())
v:SetKeyValue( "spawnflags", "32" )
v:Fire("Open","",0)
end

if math.random (1,2) == 1 then 
		SpawnItem("item_healthcharger", Vector(-1409.806152, -5823.611328, -842.550049), Angle(0.020, 90.135, -0.003) )
	elseif math.random (1,2) == 1 then 
		SpawnItem("item_healthcharger", Vector(1472.530518, -5785.539551, -986.959595), Angle(-0.000, 0.000, 0.194) )
	else 
		SpawnItem("item_healthcharger", Vector(-97.273064, -7983.509766, -603.859680), Angle(-0.151, 90.086, -0.076) )	
end
if math.random (1,2) == 1 then 
		SpawnItem("item_healthcharger", Vector(-2546.565674, -3376.469482, -954.518127), Angle(0.140, -90.080, -0.229) )
	elseif math.random (1,2) == 1 then 
		SpawnItem("item_healthcharger", Vector(661.265442, -3376.442871, -1194.557983), Angle(0.128, -89.920, -0.112) )
	else
		SpawnItem("item_healthcharger", Vector(3501.638184, -3376.422119, -1339.064819), Angle(0.073, -89.906, -0.080) )
end
if math.random (1,2) == 1 then 
		SpawnItem("item_healthcharger", Vector(4751.508301, -1518.870972, -1433.482544), Angle(-0.039, 179.840, -0.137) )
	elseif math.random (1,2) == 1 then 
		SpawnItem("item_healthcharger", Vector(2240.498779, -1311.631592, -1291.656494), Angle(0.184, 0.199, 0.291) )
	elseif math.random (1,2) == 1 then 
		SpawnItem("item_healthcharger", Vector(-383.079285, -1392.540161, -1098.911255), Angle(-0.009, -89.994, 0.353) )
	else
		SpawnItem("item_healthcharger", Vector(-4624.474609, -1460.262573, -811.617676), Angle(0.152, 179.729, 0.259) )
end

SpawnItem("npc_poisonzombie", Vector(-5206.978516, -6879.768066, -1455.968750), Angle(0.000, 178.605, 0.000))
SpawnItem("npc_zombie", Vector(-4789.912109, -6779.932129, -1455.968750), Angle(0.000, 305.250, 0.000))
SpawnItem("npc_zombie", Vector(-4234.171875, -6924.975098, -1455.968750), Angle(0.000, 155.050, 0.000))
SpawnItem("npc_zombie", Vector(-3593.132324, -7134.341309, -1455.968750), Angle(0.000, 88.000, 0.000))
SpawnItem("npc_zombie_torso", Vector(-3514.886963, -7239.567871, -1462.130737), Angle(0.000, 250.615, 0.000))
SpawnItem("npc_zombie_torso", Vector(-3583.450928, -7344.712891, -1473.007813), Angle(0.000, 88.797, 0.000))
SpawnItem("npc_fastzombie_torso", Vector(-3532.225830, -7368.507813, -1475.469482), Angle(0.000, 100.129, 0.000))
SpawnItem("npc_zombine", Vector(-2699.948975, -6978.741699, -1452.321045), Angle(0.000, 157.072, 0.000))
SpawnItem("npc_fastzombie", Vector(1178.149780, -6841.204590, -1455.968750), Angle(0.000, 179.330, 0.000))
SpawnItem("npc_poisonzombie", Vector(-2405.716797, -6859.841309, -1455.968750), Angle(0.000, 349.541, 0.000))
SpawnItem("npc_fastzombie", Vector(966.452698, -6905.286133, -1455.968750), Angle(0.000, 149.431, 0.000))
SpawnItem("npc_zombine", Vector(-257.719238, -6946.798340, -1445.318115), Angle(0.000, 9.135, 0.000))
SpawnItem("npc_zombie", Vector(-470.539215, -6827.146484, -1455.968750), Angle(0.000, 6.262, 0.000))
SpawnItem("npc_poisonzombie", Vector(-2596.104736, -300.865753, -1279.968750), Angle(0.000, 300.401, 0.000))
SpawnItem("npc_zombie", Vector(-777.988342, -6818.988281, -1455.968750), Angle(0.000, 232.350, 0.000))
SpawnItem("npc_zombie", Vector(-1470.234497, -6921.717773, -1455.968750), Angle(0.000, 22.989, 0.000))
SpawnItem("npc_fastzombie", Vector(-3206.892578, -6915.802246, -1455.968750), Angle(0.000, 64.919, 0.000))

SpawnItem("info_player_start", Vector(-4582.747559, -7342.582031, -556.333130)+Vector(0,0,-45), Angle(7.308950, 88.905434, 0.000000))
SpawnItem("info_player_start", Vector(-1690.671997, -5909.413574, -831.968750)+Vector(0,0,-60), Angle(2.567496, -0.437507, 0.000000))
SpawnItem("info_player_start", Vector(-471.238342, -7785.388184, -735.968750)+Vector(0,0,-60), Angle(4.246805, -127.863274, 0.000000))
SpawnItem("info_player_start", Vector(1289.930786, -5670.490723, -975.968750)+Vector(0,0,-45), Angle(4.543140, -33.969048, 0.000000))
SpawnItem("info_player_start", Vector(863.047180, -3121.399658, -1183.968750)+Vector(0,0,-45), Angle(2.468618, -143.219635, 0.000000))
SpawnItem("info_player_start", Vector(3637.172363, -3555.797363, -991.968750)+Vector(0,0,-60), Angle(4.839317, 89.453094, 0.000000))
SpawnItem("info_player_start", Vector(-2406.583496, -3147.460938, -607.968750)+Vector(0,0,-60), Angle(3.950299, -90.622772, 0.000000))
SpawnItem("info_player_start", Vector(2280.236328, -1382.740723, -943.968750)+Vector(0,0,-45), Angle(3.851495, -0.831817, 0.000000))
SpawnItem("info_player_start", Vector(4706.353027, -1150.367310, -1231.968750)+Vector(0,0,-60), Angle(3.851444, 177.808075, 0.000000))
SpawnItem("info_player_start", Vector(-574.704163, -1198.230591, -895.968750)+Vector(0,0,-60), Angle(3.159951, 10.573524, 0.000000))
SpawnItem("info_player_start", Vector(-4278.870117, -1091.547729, -799.968750)+Vector(0,0,-45), Angle(0.153300, -152.788681, 0.000000))

CreateHeliPath(Vector(7012.879883, -6419.743652, -730.003357))
CreateHeliPath(Vector(6571.327148, -4533.555664, -689.711243))
CreateHeliPath(Vector(5971.580566, -2492.206055, -728.127319))
CreateHeliPath(Vector(3879.848877, -2373.733398, -596.119568))
CreateHeliPath(Vector(1531.452637, -2474.693359, -441.252075))
CreateHeliPath(Vector(-416.336121, -2342.518311, -380.609680))
CreateHeliPath(Vector(-2296.614990, -2344.520752, -242.596344))
CreateHeliPath(Vector(-4727.090332, -2337.115234, -90.843353))
CreateHeliPath(Vector(-4634.597656, -643.273376, 27.802536))
CreateHeliPath(Vector(-4519.084961, -10.191533, -455.173218))
CreateHeliPath(Vector(-5680.764648, -1288.651001, -343.315887))
CreateHeliPath(Vector(-2394.027344, -2370.179932, -716.286072))
CreateHeliPath(Vector(-439.731995, -2335.916992, -820.680969))
CreateHeliPath(Vector(675.767517, -2349.388672, -905.797302))
CreateHeliPath(Vector(-420.905640, -111.663528, -809.193787))
CreateHeliPath(Vector(-177.972885, -1320.765869, -125.610123))
CreateHeliPath(Vector(-2418.684082, -3353.857910, 68.351624))
CreateHeliPath(Vector(-2487.947021, -4218.901855, -596.789368))
CreateHeliPath(Vector(-4397.416992, -2366.073242, -608.3))
CreateHeliPath(Vector(-2335.571777, -398.412354, -198.672668))
CreateHeliPath(Vector(658.822632, -3351.166016, -78.857773))
CreateHeliPath(Vector(576.097046, -4295.126465, -769.818115))
CreateHeliPath(Vector(4523.989746, -2240.154785, -1201.859863))
CreateHeliPath(Vector(4590.502930, -1336.313232, -515.707153))
CreateHeliPath(Vector(4588.373047, 10.604804, -1148.714600))
CreateHeliPath(Vector(6948.270020, -1076.551636, -683.837463))
CreateHeliPath(Vector(2489.724854, -53.340347, -977.240356))
CreateHeliPath(Vector(2457.624512, -1381.804810, -215.713074))
CreateHeliPath(Vector(3608.502686, -3384.160400, -187.629532))
CreateHeliPath(Vector(3560.312012, -4300.772949, -1027.535889))
CreateHeliPath(Vector(1231.530151, -4309.641113, -229.082581))
CreateHeliPath(Vector(861.286926, -5347.898926, -246.092529))
CreateHeliPath(Vector(-147.012207, -6887.003418, -165.289978))
CreateHeliPath(Vector(2078.041260, -6910.857910, -387.964661))
CreateHeliPath(Vector(3281.307617, -7720.813965, -489.900635))
CreateHeliPath(Vector(-1743.822876, -6854.717773, -44.532974))
CreateHeliPath(Vector(-3770.581787, -6959.965820, -62.705505))
CreateHeliPath(Vector(-5815.758301, -6974.150391, 97.909500))
CreateHeliPath(Vector(-7100.083984, -8111.645020, 148.586243))
CreateHeliPath(Vector(-5554.826172, -5026.166016, 245.697189))
CreateHeliPath(Vector(-4672.862793, -3723.520996, 101.299011))
CreateHeliPath(Vector(-1425.602783, -4811.393555, -377.801819))
CreateHeliPath(Vector(1898.437256, -4732.151855, -592.847961))
CreateHeliPath(Vector(1554.739502, -6827.413086, -744.963074))
CreateHeliPath(Vector(-100.762222, -7051.625000, -698.793152))
CreateHeliPath(Vector(-132.601837, -8565.446289, -90.050797))
CreateHeliPath(Vector(4025.716797, -6230.724609, -378.910522))
CreateHeliPath(Vector(5654.496094, -5829.375977, -604.717896))
CreateHeliPath(Vector(3093.215820, -5311.930664, -318.480774))
CreateHeliPath(Vector(1581.253784, 786.827454, -1252.681641))
CreateHeliPath(Vector(-3628.562012, -4783.553223, 117.478256))
CreateHeliPath(Vector(-4810.824219, -6042.408691, 266.021301))
CreateHeliPath(Vector(-2754.968018, -5913.759277, 118.561386))
SpawnHeliA(Vector(7012.879883, -6419.743652, -730.003357), ""..table.Random(AirEnemies).."" ,0,1)
SpawnHeliA(Vector(-7104.905273, -8087.144043, 164.011353), ""..table.Random(AirEnemies).."" ,0,1)
end

function firstwave()
Wave = 1
	if math.random (1,6) == 2 then 
		SpawnMetropoliceHard(table.Random(combinespawnzones) + Vector(math.random(-5,5), math.random(-5,5), -10), table.Random(zonescovered) + Vector(math.random(-200,250), math.random(-200,250), 0))
	else
		SpawnMetropolice(table.Random(combinespawnzones) + Vector(math.random(-5,5), math.random(-5,5), -10), table.Random(zonescovered) + Vector(math.random(-200,250), math.random(-200,250), 0))
	end
timer.Create( "coverzonesall", 0.4, 1, coverzones)
end

function secondwave()
Wave = 2

	if math.random (1,6) == 2 then 
		SpawnCombineShotgunner(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	elseif math.random (1,6) == 2 then 
		SpawnMetropoliceHard(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	else
		SpawnCombineS1(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	end

-- CanCheck = 1
timer.Create( "coverzonesall", 0.4, 1, coverzones)
end

function thirdwave()
Wave = 3
RPGCANSPAWN = 1

	if math.random (1,6) == 2 then 
		SpawnCombineShotgunner(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	elseif math.random (1,6) == 2 then 
		SpawnCombineElite1(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	else
		SpawnCombineS2(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	end
	
-- CanCheck = 1
timer.Create( "coverzonesall", 0.4, 1, coverzones)
end

function fourthwave()
Wave = 4
	if math.random (1,6) == 2 then 
		SpawnCombineShotgunnerElite(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	elseif math.random (1,6) == 2 then 
		SpawnCombineS2(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	else
		SpawnCombineElite1(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	end
	

-- CanCheck = 1
timer.Create( "coverzonesall", 0.4, 1, coverzones)
end

function fifthwave()
Wave = 5

for k, v in pairs(ents.FindByClass("npc_helicopter")) do v:Fire("gunon","",0) v.boss = 1 end
for k, v in pairs(ents.FindByClass("npc_combinegunship")) do v:Fire("gunon","",0) v.boss = 1 end

	if math.random (1,6) == 2 then 
		SpawnCombineShotgunnerElite(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	elseif math.random (1,6) == 2 then 
		SpawnCombineS2(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	else
		SpawnCombineElite2(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	end

local NumHelis = 0
for k, v in pairs(ents.FindByClass("npc_helicopter")) do
NumHelis=NumHelis+1
end

for k, v in pairs(ents.FindByClass("npc_combinegunship")) do
NumHelis=NumHelis+1
end

if NumHelis > 0 then print("too much helis")
else 
SpawnHeliA(Vector(7012.879883, -6419.743652, -730.003357), "npc_helicopter" ,0,1)
end

-- CanCheck = 1
timer.Create( "coverzonesall", 0.4, 1, coverzones)
end

function infinitewave()
Wave = 6 

	if math.random (1,6) == 2 then 
		SpawnCombineShotgunnerElite(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	elseif math.random (1,6) == 2 then 
		SpawnCombineS2(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	else
		SpawnCombineElite2(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
	end
	
if GetConVarString("h_supersoldier") == "1" then
if math.random (1,20) == 1 then 
SpawnCombineSynth(table.Random(combinespawnzones) + Vector(math.random(-5,5)))
end
end
-- CanCheck = 1
timer.Create( "coverzonesall", 0.4, 1, coverzones)
end